#!/usr/bin/env sage

N = 17408501387761496422571387531255186395594822625427018891931944274948424531840216804087406016201792609748639929234296711971006012525921492918677094417191621332330736111601665865736555524248675576283234365640108546272991072207602044576112932673004330047590294978687908382405473010869244156261269605749387676770380679964792778882683915037857456922851572226870054273144693323373449850410871470997876341208204079943211614798111409509469703286696609862614115550797655677627165801785377057385818348554957219344657509473038869337457657726576119314363978080667672646829814723388079633788309158417386736009981786671111112505803
p0 = 0xaa0f7afd50596b48004229329331258e7a3508e16898b76b134d6f5a2b009873b8a863ed506fa55a6a3140db3b1c9eec46cab0ce6608d56026cb62dad05f5ead1a6a6ebb26421621632c5e7b647124b0e9d016f395e139fada264628202f7af50000000000000000000000000000000000000000000000000000000000000000
l = 256
enc = 13379049231117532190657453732616073467792859161985883227181972507288510795162724703440583569549454207533110491760618847771838821216322814621290028928001947821505573944034675857472874883203679148854891438911854405538005691430502229662893665845524700146320897213036827063648644226906564140678401342163126370500363614868513470016023732653611112525057113030386163104323085429601812094775062497285554446279651447305571612018449904401222576586054803969482102683062018183392582432901510221006910302847026799209146553472024321478232424369745325324045939637623758793410313304754800395675157502461205254266210454626140853239295
e = 65537

X = 2^l
M = matrix([[X^2, 2*p0*X, p0^2], [0, X, p0], [0, 0, N]])
B = M.LLL()

Q = B[0][0]*x^2/X^2 + B[0][1]*x/X + B[0][2]
p = p0 + Q.roots(ring=ZZ)[0][0]
assert N % p == 0

q = N // p
phi = (p - 1) * (q - 1)
_, d, _ = xgcd(e, phi)
d = d % phi

print pow(enc, d, N)
