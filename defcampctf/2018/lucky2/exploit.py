#!/usr/bin/env python
from pwn import *
import time
import commands

for i in range(0, 1000, 10):
    log.info('i: %d' % i)
    if len(sys.argv) == 1:
        s = process('./lucky2')
    else:
        s = remote('167.99.143.206', 65032)

    code = '''
    #include <stdio.h>
    #include <stdlib.h>
    #include <time.h>

    int main(void) {
        long long seed = time(NULL) + %d;
        srand((seed * 0x66666667 >> 0x22) - (seed >> 0x1f));
        for (int i = 0; i < 100; i++) {
            printf("%%d\\n", rand());
        }
        return 0;
    }
    ''' % i
    with open('rand.c', 'w') as f:
        f.write(code)
    rand = commands.getoutput('gcc -o rand rand.c && ./rand').split('\n')

    try:
        s.sendline('A')
        for r in rand:
            s.sendline(r)
        s.stream()
        break
    except EOFError:
        s.close()
